(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a12b7d6a"],{"03f0":function(s,e,t){"use strict";var i=t("5560"),a=t.n(i);a.a},"54c8":function(s,e,t){},5560:function(s,e,t){},7631:function(s,e,t){"use strict";var i=t("54c8"),a=t.n(i);a.a},f76d:function(s,e,t){"use strict";t.r(e);var i=function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("el-form",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],staticClass:"ns-evalute"},[s._l(s.goodsList,(function(e,i){return t("div",{key:i,staticClass:"ns-eva-li"},[t("div",{staticClass:"ns-eva-good"},[t("el-image",{attrs:{fit:"scale-down",src:s.$img(e.sku_image,{size:"mid"})},on:{error:function(e){return s.imageError(i)},click:function(t){return s.toGoodsDetail(e.sku_id)}}}),t("p",{staticClass:"ns-eva-good-name",attrs:{title:e.sku_name},on:{click:function(t){return s.toGoodsDetail(e.sku_id)}}},[s._v(s._s(e.sku_name))]),t("p",[s._v("￥"+s._s(e.price))])],1),t("div",{staticClass:"ns-eva-form"},[s.isEvaluate?s._e():t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[s._v("描述相符：")]),t("el-rate",{on:{change:function(e){return s.setStar(i)}},model:{value:s.goodsEvalList[i].scores,callback:function(e){s.$set(s.goodsEvalList[i],"scores",e)},expression:"goodsEvalList[index].scores"}}),t("div",{staticClass:"level"},[t("i",{staticClass:"iconfont",class:"1"==s.goodsEvalList[i].explain_type?"iconhaoping1 ns-text-color":"2"==s.goodsEvalList[i].explain_type?"iconzhongchaping ns-text-color":"3"==s.goodsEvalList[i].explain_type?"iconzhongchaping":""}),t("span",[s._v(" "+s._s("1"==s.goodsEvalList[i].explain_type?"好评":"2"==s.goodsEvalList[i].explain_type?"中评":"3"==s.goodsEvalList[i].explain_type?"差评":"")+" ")])])],1),t("div",{staticClass:"ns-textarea"},[s.isEvaluate?t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请在此处输入您的追评",maxlength:"200","show-word-limit":""},model:{value:s.goodsEvalList[i].again_content,callback:function(e){s.$set(s.goodsEvalList[i],"again_content",e)},expression:"goodsEvalList[index].again_content"}}):t("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请在此处输入您的评价",maxlength:"200","show-word-limit":""},model:{value:s.goodsEvalList[i].content,callback:function(e){s.$set(s.goodsEvalList[i],"content",e)},expression:"goodsEvalList[index].content"}})],1),t("el-upload",{ref:"upload",refInFor:!0,class:{ishide:s.hide[i]},attrs:{action:s.uploadActionUrl,"list-type":"picture-card","on-success":function(e,t){return s.handleSuccess(e,t,i)},"on-preview":s.handlePictureCardPreview,"on-remove":function(e,t){return s.handleRemove(e,t,i)},"on-exceed":s.handleExceed}},[t("i",{staticClass:"el-icon-plus"})]),t("el-dialog",{attrs:{visible:s.dialogVisible},on:{"update:visible":function(e){s.dialogVisible=e}}},[t("img",{attrs:{width:"100%",src:s.dialogImageUrl,alt:""}})]),t("span",[s._v("共6张，还能上传"+s._s(s.imgList[i].length?6-s.imgList[i].length:6)+"张")])],1)])})),s.isEvaluate?s._e():t("div",{staticClass:"ns-eva-public"},[t("div",{staticClass:"ns-eva-wrap"},[t("p",[s._v(s._s(s.siteName))]),t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[s._v("配送服务：")]),t("el-rate",{model:{value:s.shop_deliverycredit,callback:function(e){s.shop_deliverycredit=e},expression:"shop_deliverycredit"}})],1),t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[s._v("描述相符：")]),t("el-rate",{model:{value:s.shop_desccredit,callback:function(e){s.shop_desccredit=e},expression:"shop_desccredit"}})],1),t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[s._v("服务态度：")]),t("el-rate",{model:{value:s.shop_servicecredit,callback:function(e){s.shop_servicecredit=e},expression:"shop_servicecredit"}})],1),t("el-checkbox",{model:{value:s.isAnonymous,callback:function(e){s.isAnonymous=e},expression:"isAnonymous"}},[s._v("匿名")])],1)]),t("div",{staticClass:"save-btn-wrap"},[t("el-button",{attrs:{type:"primary"},on:{click:s.save}},[s._v("提交")])],1)],2)},a=[],o=(t("99af"),t("a434"),t("d3b7"),t("25f0"),t("498a"),t("5530")),n=t("2f62"),r=t("dea0"),d=t("01ea"),l={name:"evaluate",components:{},data:function(){return{loading:!0,value1:5,memberName:"",memberNeadimg:"",orderId:null,orderNo:"",isAnonymous:0,goodsList:[],goodsEvalList:[],imgList:[],isEvaluate:0,flag:!1,siteName:"",shop_deliverycredit:5,shop_desccredit:5,shop_servicecredit:5,uploadActionUrl:d["a"].baseUrl+"/api/upload/evaluateimg",dialogImageUrl:"",dialogVisible:!1,hide:[]}},created:function(){this.orderId=this.$route.query.order_id,this.getUserInfo(),this.orderId&&this.getOrderInfo()},computed:Object(o["a"])({},Object(n["b"])(["defaultGoodsImage"])),methods:{handleSuccess:function(s,e,t){var i=this.imgList[t];i=i.concat(s.data.pic_path),this.imgList[t]=[],this.$set(this.imgList,t,i),this.isEvaluate?this.goodsEvalList[t].again_images=this.imgList[t].toString():this.goodsEvalList[t].images=this.imgList[t].toString(),this.imgList[t].length>=6&&(this.hide[t]=!0)},handleRemove:function(s,e,t){var i=util.inArray(s.response.data.pic_path,this.imgList[t]);this.imgList[t].splice(i,1),this.isEvaluate?this.goodsEvalList[t].again_images=this.imgList[t].toString():this.goodsEvalList[t].images=this.imgList[t].toString(),this.imgList[t].length<6&&(this.hide[t]=!1)},handleExceed:function(s,e){this.$message.warning("上传图片最大数量为6张")},handlePictureCardPreview:function(s){this.dialogImageUrl=s.url,this.dialogVisible=!0},getUserInfo:function(){var s=this;this.$store.dispatch("member/member_detail",{refresh:1}).then((function(e){s.memberName=e.data.nickname,s.memberNeadimg=e.data.headimg})).catch((function(e){s.$message.error(e.message)}))},getOrderInfo:function(){var s=this;Object(r["g"])({order_id:this.orderId}).then((function(e){if(0==e.code)if(s.isEvaluate=e.data.evaluate_status,s.orderNo=e.data.list[0].order_no,s.goodsList=e.data.list,s.siteName=e.data.list[0].site_name,s.isEvaluate)for(var t=0;t<e.data.list.length;t++){var i=[];s.imgList.push(i),s.hide.push(!1),s.goodsEvalList.push({order_goods_id:e.data.list[t].order_goods_id,goods_id:e.data.list[t].goods_id,sku_id:e.data.list[t].sku_id,again_content:"",again_images:"",site_id:e.data.list[t].site_id})}else for(var a=0;a<e.data.list.length;a++){var o=[];s.imgList.push(o),s.goodsEvalList.push({content:"",images:"",scores:5,explain_type:1,order_goods_id:e.data.list[a].order_goods_id,goods_id:e.data.list[a].goods_id,sku_id:e.data.list[a].sku_id,sku_name:e.data.list[a].sku_name,sku_price:e.data.list[a].price,sku_image:e.data.list[a].sku_image,site_id:e.data.list[a].site_id})}s.loading=!1})).catch((function(e){s.$message.error(e.message),s.$router.push("/member/order_list"),s.loading=!1}))},setStar:function(s){this.goodsEvalList[s].scores>=4?this.goodsEvalList[s].explain_type=1:1<this.goodsEvalList[s].scores&&this.goodsEvalList[s].scores<4?this.goodsEvalList[s].explain_type=2:this.goodsEvalList[s].explain_type=3},imageError:function(s){this.goodsList[s].sku_image=this.defaultGoodsImage},save:function(){for(var s=this,e=0;e<this.goodsEvalList.length;e++)if(this.isEvaluate){if(!this.goodsEvalList[e].again_content.trim().length)return void this.$message({message:"商品的评价不能为空哦",type:"warning"})}else if(!this.goodsEvalList[e].content.trim().length)return void this.$message({message:"商品的评价不能为空哦",type:"warning"});var t=JSON.stringify(this.goodsEvalList),i={order_id:this.orderId,goods_evaluate:t,isEvaluate:this.isEvaluate};this.isEvaluate||(i.order_no=this.orderNo,i.member_name=this.memberName,i.member_headimg=this.memberNeadimg,i.is_anonymous=this.isAnonymous,i.shop_deliverycredit=this.shop_deliverycredit,i.shop_desccredit=this.shop_desccredit,i.shop_servicecredit=this.shop_servicecredit),this.flag||(this.flag=!0,Object(r["h"])(i).then((function(e){0==e.code?s.$message({message:"评价成功",type:"success",duration:2e3,onClose:function(){s.$router.push({path:"/member/order_list"})}}):(s.$message({message:e.message,type:"warning"}),s.flag=!1)})).catch((function(e){s.$message.error(e.message),s.flag=!1})))},toGoodsDetail:function(s){this.$router.pushToTab("sku-"+s)}}},c=l,g=(t("7631"),t("03f0"),t("2877")),u=Object(g["a"])(c,i,a,!1,null,"4de193c2",null);e["default"]=u.exports}}]);
//# sourceMappingURL=chunk-a12b7d6a.caa73844.js.map