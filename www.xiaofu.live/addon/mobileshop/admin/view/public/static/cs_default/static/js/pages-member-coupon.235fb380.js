(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-member-coupon"],{"285f":function(e,t,i){"use strict";var o=i("af80"),n=i.n(o);n.a},4399:function(e,t,i){"use strict";i.r(t);var o=i("c6bc"),n=i.n(o);for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);t["default"]=n.a},7103:function(e,t,i){"use strict";i.r(t);var o=i("860e"),n=i("4399");for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);i("285f");var c,s=i("f0c5"),r=Object(s["a"])(n["default"],o["b"],o["c"],!1,null,"47f65c5b",null,!1,o["a"],c);t["default"]=r.exports},"7c16":function(e,t,i){var o=i("24fb");t=o(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n */.uni-line-hide[data-v-47f65c5b]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.uni-using-hide[data-v-47f65c5b]{overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap}.prevent-head-roll[data-v-47f65c5b]{position:fixed;left:0;right:0;z-index:998}uni-page-body[data-v-47f65c5b]{overflow:hidden}.coupon[data-v-47f65c5b]{overflow:hidden}.disabled[data-v-47f65c5b]{background-color:#ccc}.coupon-item[data-v-47f65c5b]{display:-webkit-box;display:-webkit-flex;display:flex;margin:%?30?% %?30?% 0;height:%?170?%;background-size:contain;background-repeat:no-repeat}.coupon-item .coupon-title[data-v-47f65c5b]{padding-left:%?10?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;width:%?198?%;color:#fff;box-sizing:border-box}.coupon-item .coupon-content[data-v-47f65c5b]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;padding:0 %?30?%;width:%?356?%}.coupon-item .coupon-content .coupon-name[data-v-47f65c5b]{margin-top:%?10?%;line-height:1.5;height:%?86?%}.coupon-item .coupon-content .coupon-time[data-v-47f65c5b]{margin-top:%?10?%;border-top:%?2?% dashed #eee;padding-top:%?6?%;font-size:%?24?%}.coupon-item .coupon-money[data-v-47f65c5b]{text-align:center;font-size:%?50?%}.coupon-item .coupon-money uni-text[data-v-47f65c5b]{font-size:%?30?%}.coupon-item .checkbox[data-v-47f65c5b]{color:#909399;margin-right:%?10?%}.footer-wrap[data-v-47f65c5b]{position:fixed;width:100%;bottom:0;padding:%?40?% 0;z-index:10;padding-bottom:calc(constant(safe-area-inset-bottom) + %?100?%);padding-bottom:calc(env(safe-area-inset-bottom) + %?100?%)}',""]),e.exports=t},"860e":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return o}));var o={nsEmpty:i("d548").default,loadingCover:i("8f54").default},n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"coupon"},[i("mescroll-uni",{attrs:{refs:"mescroll",size:10},on:{getData:function(t){arguments[0]=t=e.$handleEvent(t),e.getCouponData.apply(void 0,arguments)}}},[i("template",{attrs:{slot:"list"},slot:"list"},[e.couponData.length?e._l(e.couponData,(function(t,o){return i("v-uni-view",{key:o,staticClass:"coupon-item",style:{backgroundImage:"url("+e.$util.img("upload/uniapp/shop_uniapp/member/coupon_bg.png")+")"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.isChecked(t)}}},[i("v-uni-view",{staticClass:"coupon-title"},[i("v-uni-text",{staticClass:"coupon-money uni-using-hide"},[i("v-uni-text",[e._v("￥")]),e._v(e._s(parseInt(t.money)))],1),i("v-uni-text",{staticClass:"uni-using-hide"},[e._v("满"+e._s(parseInt(t.at_least))+"可用")])],1),i("v-uni-view",{staticClass:"coupon-content"},[i("v-uni-text",{staticClass:"coupon-name uni-line-hide"},[e._v(e._s(t.coupon_name))]),i("v-uni-text",{staticClass:"coupon-time"},[e._v(e._s(t.expireTime))])],1),i("v-uni-view",{staticClass:"checkbox-wrap"},[i("v-uni-text",{staticClass:"checkbox iconfont",class:t.checked?"iconfuxuankuang1 color-base-text":"iconfuxuankuang2"})],1)],1)})):!e.couponData.length&&e.emptyShow?i("ns-empty"):e._e()],2)],2),e.couponData.length?i("v-uni-view",{staticClass:"footer-wrap"},[i("v-uni-button",{attrs:{type:"primary",disabled:!Boolean(e.couponArr.length)},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.save()}}},[e._v("发放优惠券")])],1):e._e(),i("loading-cover",{ref:"loadingCover"})],1)},a=[]},af80:function(e,t,i){var o=i("7c16");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var n=i("4f06").default;n("3cc6968c",o,!0,{sourceMap:!1,shadowMode:!1})},c6bc:function(e,t,i){"use strict";i("99af"),i("4160"),i("c975"),i("a434"),i("d3b7"),i("25f0"),i("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{emptyShow:!1,memberId:0,couponData:[],couponArr:[],repeatFlag:!1}},onLoad:function(e){e.member_id?this.memberId=e.member_id:this.$util.redirectTo("/pages/member/list",{},"redirectTo"),this.$util.checkToken("/pages/member/detail?member_id="+this.memberId)},methods:{isChecked:function(e){e.checked=!e.checked,e.checked?this.couponArr.push(e.coupon_type_id):this.couponArr.splice(this.couponArr.indexOf(e.coupon_type_id),1)},getCouponData:function(e){var t=this,i={page_size:e.size,page:e.num,member_id:this.memberId,status:1};this.mescroll=e,this.$api.sendRequest({url:"/coupon/shopapi/coupon/lists",data:i,success:function(i){var o=[],n=i.message;0==i.code&&i.data?o=i.data.list:t.$util.showToast({title:n}),e.endSuccess(o.length),1==e.num&&(t.dataList=[]),o.forEach((function(e){t.$set(e,"checked",!1),0==e.validity_type?e.expireTime="有效期："+t.$util.timeStampTurnTime(e.end_time):1==e.validity_type&&(e.expireTime="领取之日起"+e.fixed_term+"天有效")})),t.couponData=t.couponData.concat(o),t.emptyShow=!0,t.$refs.loadingCover&&t.$refs.loadingCover.hide()}})},save:function(){var e=this;if(!this.repeatFlag){this.repeatFlag=!0;var t=this.couponArr.toString();this.$api.sendRequest({url:"/coupon/shopapi/coupon/send",data:{member_id:this.memberId,parent:t},success:function(t){e.repeatFlag=!1,0==t.code?(e.$util.showToast({title:"优惠券发放成功"}),setTimeout((function(){e.$util.redirectTo("/pages/member/list")}),1e3)):e.$util.showToast({title:t.message})}})}}}};t.default=o}}]);